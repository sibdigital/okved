<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Создание ОКВЭДа</title>
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection">
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/materialize.min.js"></script>

</head>
<body>
    <div class="container">
        <div class="row">
            <div class="input-field col s6">
                <input id="kind_code" type="text" class="validate" required>
                <label for="kind_code">Код</label>
            </div>
            <div class="input-field col s6">
                <input id="version" type="text" class="validate" th:value="${version}" readonly>
                <label for="version">Версия</label>
            </div>
            <div class="input-field col s12">
                <input id="kind_name" type="text" class="validate" th:value="${kind_name}" required>
                <label for="kind_name">Наименование</label>
            </div>
            <div class="input-field col s12">
                <textarea class="materialize-textarea" id = "description" >
                </textarea>
                <label for="description">Описание</label>
            </div>
            <div class="col s12" >
                <label for="radio-group">Статус</label>
                <div id="radio-group">
                    <label class="container">
                        <input type="radio" id="checkbox1" checked="checked" name="radio">
                        <span class="checkmark"></span>
                        <b >Работа разрешена</b>
                    </label><br>
                    <label class="container">
                        <input type="radio" id="checkbox0" name="radio">
                        <span class="checkmark"></span>
                        <b>Работа приостановлена</b>
                    </label>
                </div>
            </div>
            <div class="input-field col s2">
                <button class="waves-effect waves-light btn" type="button" id="button-create">Создать ОКВЭД</button>
            </div>
        </div>
    </div>

    <script>
        $('#button-create').click(function () {
            if ($("#kind_code").val() != "" && $("#kind_code").val() != "") {
                const form = $('#form')[0];
                const data = new FormData(form);
                data.append('kind_name', $('#kind_name').val());
                data.append('kind_code', $('#kind_code').val());
                data.append('description', $('#description').val());
                if (document.getElementById("checkbox1").checked == true) {
                    data.append('status', 1);
                } else {
                    data.append('status', 0);
                }
                $.ajax({
                    type: 'POST',
                    enctype: 'multipart/form-data',
                    url: '/create_okved',
                    data: data,
                    processData: false,
                    contentType: false,
                    cache: false,
                    success: function (data) {
                        console.log(data);
                        var name = $('#kind_code').val() + " " + $('#kind_name').val();
                        clearAll();
                        alert("ОКВЭД " + name + " сохранен");
                    },
                    error: function (e) {
                        console.log(e);
                    }
                });
            }
            else {
                alert('Заполните обязательные поля')
            }
        })

        function clearAll() {
            document.getElementById('kind_code').value = '';
            document.getElementById('kind_name').value = '';
            document.getElementById('description').value = '';
        }
    </script>
</body>
</html>